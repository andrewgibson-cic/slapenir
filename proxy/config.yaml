# SLAPENIR Proxy Configuration
# Simplified configuration with only credentials that have environment variables set

# Strategy Definitions
strategies:
  # GitHub API Strategy
  - name: github
    type: bearer
    config:
      env_var: GITHUB_TOKEN
      dummy_pattern: "DUMMY_GITHUB"
      allowed_hosts:
        - "api.github.com"
        - "github.com"
        - "*.github.com"
  
  # Google Gemini API Strategy
  - name: gemini
    type: bearer
    config:
      env_var: GEMINI_API_KEY
      dummy_pattern: "DUMMY_GEMINI"
      allowed_hosts:
        - "generativelanguage.googleapis.com"
        - "*.googleapis.com"
  
  # Mistral AI API Strategy
  - name: mistral
    type: bearer
    config:
      env_var: MISTRAL_API_KEY
      dummy_pattern: "DUMMY_MISTRAL"
      allowed_hosts:
        - "api.mistral.ai"
        - "*.mistral.ai"
  
  # Slack Bot Token API Strategy
  - name: slack-bot
    type: bearer
    config:
      env_var: SLACK_BOT_TOKEN
      dummy_pattern: "xoxb-DUMMY"
      allowed_hosts:
        - "slack.com"
        - "*.slack.com"
  
  # Slack App Token API Strategy
  - name: slack-app
    type: bearer
    config:
      env_var: SLACK_APP_TOKEN
      dummy_pattern: "xapp-DUMMY"
      allowed_hosts:
        - "slack.com"
        - "*.slack.com"
  
  # IBM ICA API Strategy
  - name: ibm-ica
    type: bearer
    config:
      env_var: ICA_API_KEY
      dummy_pattern: "DUMMY_ICA"
      allowed_hosts:
        - "servicesessentials.ibm.com"
        - "*.ibm.com"
  
  # Semantic Scholar API Strategy
  - name: semantic-scholar
    type: bearer
    config:
      env_var: S2_API_KEY
      dummy_pattern: "DUMMY_S2"
      allowed_hosts:
        - "api.semanticscholar.org"
        - "*.semanticscholar.org"

# Injection Rules
# Rules define when to apply each strategy based on request characteristics
rules:
  # GitHub Rule
  - name: github-injection
    domain_regex: "^(.*\\.)?github\\.com$"
    trigger_header_regex: "DUMMY_GITHUB"
    strategy: github
    priority: 100
  
  # Google Gemini Rule
  - name: gemini-injection
    domain_regex: "^(.*\\.)?googleapis\\.com$"
    trigger_header_regex: "DUMMY_GEMINI"
    strategy: gemini
    priority: 100
  
  # Mistral AI Rule
  - name: mistral-injection
    domain_regex: "^(.*\\.)?mistral\\.ai$"
    trigger_header_regex: "DUMMY_MISTRAL"
    strategy: mistral
    priority: 100
  
  # Slack Bot Token Rule
  - name: slack-bot-injection
    domain_regex: "^(.*\\.)?slack\\.com$"
    trigger_header_regex: "xoxb-DUMMY"
    strategy: slack-bot
    priority: 100
  
  # Slack App Token Rule
  - name: slack-app-injection
    domain_regex: "^(.*\\.)?slack\\.com$"
    trigger_header_regex: "xapp-DUMMY"
    strategy: slack-app
    priority: 110
  
  # IBM ICA Rule
  - name: ibm-ica-injection
    domain_regex: "^(.*servicesessentials\\.ibm\\.com|.*\\.ibm\\.com)$"
    trigger_header_regex: "DUMMY_ICA"
    strategy: ibm-ica
    priority: 100
  
  # Semantic Scholar Rule
  - name: semantic-scholar-injection
    domain_regex: "^(.*\\.)?semanticscholar\\.org$"
    trigger_header_regex: "DUMMY_S2"
    strategy: semantic-scholar
    priority: 100

# Global Settings
settings:
  # Logging configuration
  log_level: DEBUG  # DEBUG, INFO, WARNING, ERROR
  log_format: json  # json or text
  
  # Security settings
  fail_mode: closed  # closed (drop on error) or open (pass through on error)
  
  # Performance settings
  max_body_size_mb: 100  # Maximum body size to process (larger uses streaming)
  
  # Telemetry blocking (optional)
  block_telemetry: true
  telemetry_domains:
    - "telemetry.anthropic.com"
    - "sentry.io"
    - "*.sentry.io"
    - "analytics.google.com"
    - "*.segment.com"
    - "*.mixpanel.com"
    - "*.amplitude.com"
    - "api.cline.bot"
    - "*.cline.bot"
